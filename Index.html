<!DOCTYPE html><html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malla Interactiva - Farmacia UNAL</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f8f9fa;
    }
    h1, h2 {
      text-align: center;
      color: #004080;
    }
    #malla {
      display: flex;
      overflow-x: auto;
      gap: 16px;
      padding: 10px 0;
    }
    .semestre {
      background: white;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 10px;
      min-width: 240px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .semestre h3 {
      text-align: center;
      margin-bottom: 8px;
    }
    .materia {
      padding: 6px;
      margin-bottom: 6px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 0.9em;
      cursor: pointer;
    }
    .bloqueada {
      background-color: #f8d7da;
      color: #721c24;
    }
    .aprobada {
      background-color: #d4edda !important;
      color: #155724;
    }
    .quimica { background-color: #e0f0ff; }
    .biologica { background-color: #e0ffe8; }
    .farmaceutica { background-color: #fff3cd; }
    .administrativa { background-color: #f3e8ff; }
    .optativa { background-color: #eeeeee; }
    #avanceContainer {
      text-align: center;
      margin: 12px 0;
      font-size: 1.1em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 8px;
      text-align: center;
    }
    input[type="number"] {
      width: 60px;
    }
    button {
      margin: 10px auto;
      display: block;
      padding: 6px 12px;
      font-size: 1em;
      background-color: #004080;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Farmacia UNAL</h1>
  <div id="avanceContainer">Avance: <span id="avance">0%</span></div>
  <button onclick="resetearMalla()">ðŸ”„ Reiniciar malla</button>
  <div id="malla"></div>  <h2>Calculadora de PAPA</h2>
  <table id="tablaPapa">
    <thead>
      <tr>
        <th>Asignatura</th>
        <th>CrÃ©ditos</th>
        <th>Nota 1</th>
        <th>Nota 2</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <p style="text-align:center"><strong>PAPA:</strong> <span id="papaCalculado">--</span></p>  <script>
    document.addEventListener("DOMContentLoaded", function () {
    const materiasPorSemestre = [
  [
    { nombre: "Principios de quÃ­mica", creditos: 3, area: "quimica", correq: ["Lab de tÃ©cnicas bÃ¡sicas en quÃ­mica"] },
    { nombre: "Lab de tÃ©cnicas bÃ¡sicas en quÃ­mica", creditos: 3, area: "quimica" },
    { nombre: "CÃ¡lculo diferencial", creditos: 4, area: "quimica" },
    { nombre: "BiologÃ­a molecular y celular", creditos: 3, area: "biologica" },
    { nombre: "IntroducciÃ³n a la farmacia", creditos: 2, area: "farmaceutica" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" }
  ],
  [
    { nombre: "QuÃ­mica orgÃ¡nica 1", creditos: 3, area: "quimica", prereq: ["Principios de quÃ­mica"], correq: ["Lab de quÃ­mica orgÃ¡nica"] },
    { nombre: "Lab de quÃ­mica orgÃ¡nica", creditos: 3, area: "quimica", prereq: ["Lab de tÃ©cnicas bÃ¡sicas en quÃ­mica"] },
    { nombre: "Principios de anÃ¡lisis quÃ­mico", creditos: 3, area: "quimica", prereq: ["Principios de quÃ­mica"] },
    { nombre: "MecÃ¡nica y ondas para biociencias", creditos: 4, area: "quimica" },
    { nombre: "BioestadÃ­stica fundamental", creditos: 3, area: "biologica" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" }
  ],
  [
    { nombre: "QuÃ­mica orgÃ¡nica 2", creditos: 3, area: "quimica", prereq: ["QuÃ­mica orgÃ¡nica 1"], correq: ["BioquÃ­mica"] },
    { nombre: "Lab de principios de anÃ¡lisis quÃ­mico", creditos: 3, area: "quimica", prereq: ["Lab de tÃ©cnicas bÃ¡sicas en quÃ­mica"], correq: ["Principios de anÃ¡lisis quÃ­mico"] },
    { nombre: "BioquÃ­mica", creditos: 3, area: "biologica", prereq: ["QuÃ­mica orgÃ¡nica 1", "BiologÃ­a molecular y celular"] },
    { nombre: "FisicoquÃ­mica", creditos: 3, area: "quimica", prereq: ["Principios de anÃ¡lisis quÃ­mico"] },
    { nombre: "QuÃ­mica inorgÃ¡nica farmacÃ©utica", creditos: 2, area: "quimica", prereq: ["Principios de quÃ­mica", "IntroducciÃ³n a la farmacia"] },
    { nombre: "Optativa de fundamentaciÃ³n", creditos: 3, area: "optativa" }
  ],
  [
    { nombre: "FisioanatomÃ­a", creditos: 3, area: "biologica", prereq: ["BioquÃ­mica"] },
    { nombre: "MicrobiologÃ­a general", creditos: 3, area: "biologica", prereq: ["BioquÃ­mica"] },
    { nombre: "Operaciones unitarias farmacÃ©uticas", creditos: 2, area: "farmaceutica", prereq: ["FisicoquÃ­mica", "MecÃ¡nica y ondas para biociencias"] },
    { nombre: "Farmacognosia y fitoquÃ­mica", creditos: 4, area: "farmaceutica", prereq: ["QuÃ­mica orgÃ¡nica 2", "BioquÃ­mica", "Lab de quÃ­mica orgÃ¡nica"] },
    { nombre: "Optativa de fundamentaciÃ³n", creditos: 3, area: "optativa" },
    { nombre: "Libre elecciÃ³n", creditos: 4, area: "optativa" }
  ],
  [
    { nombre: "FisiopatologÃ­a", creditos: 3, area: "biologica", prereq: ["FisioanatomÃ­a"] },
    { nombre: "MicrobiologÃ­a farmacÃ©utica", creditos: 3, area: "biologica", prereq: ["MicrobiologÃ­a general"] },
    { nombre: "Farmacotecnia 1", creditos: 4, area: "farmaceutica", prereq: ["QuÃ­mica orgÃ¡nica 2", "Operaciones unitarias farmacÃ©uticas", "QuÃ­mica inorgÃ¡nica farmacÃ©utica"] },
    { nombre: "Farmacia quÃ­mica 1", creditos: 4, area: "farmaceutica", prereq: ["Farmacognosia y fitoquÃ­mica"] },
    { nombre: "Optativa de fundamentaciÃ³n", creditos: 3, area: "optativa" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" }
  ],
  [
    { nombre: "FarmacologÃ­a general", creditos: 3, area: "biologica", prereq: ["FisiopatologÃ­a"] },
    { nombre: "Salud pÃºblica y farmacia", creditos: 2, area: "administrativa", prereq: ["FisiopatologÃ­a", "BioestadÃ­stica fundamental", "IntroducciÃ³n a la farmacia"] },
    { nombre: "Farmacotecnia 2", creditos: 4, area: "farmaceutica", prereq: ["Farmacotecnia 1"] },
    { nombre: "AnÃ¡lisis instrumental farmacÃ©utico", creditos: 4, area: "farmaceutica", prereq: ["Lab de principios de anÃ¡lisis quÃ­mico", "Principios de anÃ¡lisis quÃ­mico", "Farmacotecnia 1"] },
    { nombre: "Biofarmacia y farmacocinÃ©tica", creditos: 2, area: "farmaceutica", prereq: ["Farmacotecnia 1", "FisioanatomÃ­a"] },
    { nombre: "Farmacia quÃ­mica 2", creditos: 2, area: "farmaceutica", prereq: ["Farmacia quÃ­mica 1"] }
  ],
  [
    { nombre: "FarmacologÃ­a especial", creditos: 3, area: "biologica", prereq: ["FarmacologÃ­a general", "MicrobiologÃ­a general"] },
    { nombre: "GestiÃ³n de servicios farmacÃ©uticos", creditos: 2, area: "administrativa", prereq: ["Salud pÃºblica y farmacia"] },
    { nombre: "LegislaciÃ³n farmacÃ©utica", creditos: 2, area: "administrativa", prereq: ["Salud pÃºblica y farmacia", "AnÃ¡lisis instrumental farmacÃ©utico"] },
    { nombre: "AdministraciÃ³n farmacÃ©utica", creditos: 2, area: "administrativa", correq: ["Salud pÃºblica y farmacia"] },
    { nombre: "ToxicologÃ­a", creditos: 3, area: "biologica", prereq: ["FarmacologÃ­a general"] },
    { nombre: "Optativa disciplinar", creditos: 3, area: "optativa" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" }
  ],
  [
    { nombre: "Farmacia industrial", creditos: 4, area: "farmaceutica", prereq: ["MicrobiologÃ­a farmacÃ©utica", "Farmacotecnia 2", "AnÃ¡lisis instrumental farmacÃ©utico"] },
    { nombre: "Control de calidad farmacÃ©utico", creditos: 4, area: "farmaceutica", prereq: ["Farmacotecnia 2", "AnÃ¡lisis instrumental farmacÃ©utico", "MicrobiologÃ­a farmacÃ©utica"] },
    { nombre: "Aseguramiento de calidad", creditos: 2, area: "farmaceutica", prereq: ["AdministraciÃ³n farmacÃ©utica", "AnÃ¡lisis instrumental farmacÃ©utico"] },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" },
    { nombre: "Optativa disciplinar", creditos: 3, area: "optativa" }
  ],
  [
    { nombre: "Farmacia hospitalaria", creditos: 9, area: "farmaceutica", prereq: ["FarmacologÃ­a especial", "Farmacia industrial", "GestiÃ³n de servicios farmacÃ©uticos", "LegislaciÃ³n farmacÃ©utica", "ToxicologÃ­a", "Aseguramiento de calidad"] },
    { nombre: "Optativa disciplinar", creditos: 3, area: "optativa" },
    { nombre: "Optativa disciplinar", creditos: 3, area: "optativa" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" }
  ],
  [
    { nombre: "Trabajo de grado", creditos: 8, area: "farmaceutica", prereq: ["TODAS"] },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" },
    { nombre: "Libre elecciÃ³n", creditos: 3, area: "optativa" }
  ]
]; // solo semestre 1 de ejemplo para ver si se renderiza

    const vistas = new Set();

    function crearElementoMateria(materia, index) {
      const div = document.createElement("div");
      const nombreFinal = `${materia.nombre} (${index})`;
      if (vistas.has(nombreFinal)) div.classList.add("aprobada");
      div.dataset.id = nombreFinal;

      div.addEventListener("click", () => {
        if (div.classList.contains("bloqueada")) return;
        const id = div.dataset.id;
        if (vistas.has(id)) {
          vistas.delete(id);
          div.classList.remove("aprobada");
        } else {
          vistas.add(id);
          div.classList.add("aprobada");
        } else {
          vistas.add(nombreFinal);
        }
        
      });

      return div;
    }

    function requisitosCumplidos(materia) {
      return true; // para prueba sin requisitos
    }

    function renderizarMalla() {
      const contenedor = document.getElementById("malla");
      contenedor.innerHTML = "";
      materiasPorSemestre.forEach((semestre, i) => {
        const columna = document.createElement("div");
        columna.className = "semestre";
        const titulo = document.createElement("h3");
        titulo.textContent = `Semestre ${i + 1}`;
        columna.appendChild(titulo);

        semestre.forEach((materia, j) => {
          materia.bloqueada = !requisitosCumplidos(materia);
          const div = crearElementoMateria(materia, `${i + 1}-${j + 1}`);
          columna.appendChild(div);
        });

        contenedor.appendChild(columna);
      });
    }

    function actualizarCalculadora() {
      const tabla = document.querySelector('#tablaPapa tbody');
      tabla.innerHTML = '';

      const agregadas = new Set();
      materiasPorSemestre.flat().forEach((m, i) => {
        const nombreUnico = (m.nombre.startsWith("Optativa") || m.nombre.startsWith("Libre elecciÃ³n")) ? `${m.nombre} (${i})` : m.nombre;
        if (!agregadas.has(nombreUnico)) {
          agregarFila(nombreUnico, m.creditos);
          agregadas.add(nombreUnico);
        }
      });
      calcularPapa();
    }

    function agregarFila(nombre = '', creditos = '') {
      const fila = document.createElement('tr');
      fila.innerHTML = `
        <td><input type="text" value="${nombre}"/></td>
        <td><input type="number" value="${creditos}" min="1"/></td>
        <td><input type="number" min="0" max="5" step="0.1"/></td>
        <td><input type="number" min="0" max="5" step="0.1"/></td>
      `;
      document.querySelector('#tablaPapa tbody').appendChild(fila);
      fila.querySelectorAll('input').forEach(input => {
        input.addEventListener('input', calcularPapa);
      });
    }

    function calcularPapa() {
      let sumaPonderada = 0;
      let sumaCreditos = 0;
      document.querySelectorAll('#tablaPapa tbody tr').forEach(fila => {
        const nombre = fila.cells[0].querySelector('input').value.trim();
        const creditos = parseFloat(fila.cells[1].querySelector('input').value);
        const nota1 = parseFloat(fila.cells[2].querySelector('input').value);
        const nota2 = parseFloat(fila.cells[3].querySelector('input').value);
        if (!nombre || isNaN(creditos)) return;
        let notaFinal;
        if (!isNaN(nota1) && !isNaN(nota2)) notaFinal = Math.max(nota1, nota2);
        else if (!isNaN(nota1)) notaFinal = nota1;
        else if (!isNaN(nota2)) notaFinal = nota2;
        else return;
        sumaPonderada += notaFinal * creditos;
        sumaCreditos += creditos;
      });
      const promedio = sumaCreditos ? (sumaPonderada / sumaCreditos).toFixed(2) : '--';
      document.getElementById('papaCalculado').textContent = promedio;
    }

    function resetearMalla() {
      vistas.clear();
      renderizarMalla();
      actualizarCalculadora();
    }

    renderizarMalla();
    actualizarCalculadora();
        renderizarMalla();
      actualizarCalculadora();
    });
  </script></body>
</html>
